<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 在sublime中编译ES6语法 · Vic's Posts</title><meta name="description" content="在sublime中编译ES6语法 - vic"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/avatar.jpg"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/vicerwang" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://www.zhihu.com/people/wang-jin-liang-69" target="_blank" class="nav-list-link">ZHIHU</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">在sublime中编译ES6语法</h1><div class="post-meta"><div class="post-time">Dec 24, 2015</div></div><div class="post-content"><p>ECMAScript 6是JavaScript语言的下一代标准，已经在2015年6月正式发布了。那么我们如何学习测试ES6新提出的那些特性呢，是写一个带有javascript的html文件在浏览器里运行下或者在浏览器的控制台输入js代码么？显然不靠谱啊，浏览器对新标准的支持总是滞后的。我知道，你想说还有node，babel呢，但是通过终端的REPL或者执行babel的编译命令查看运行结果，还是很麻烦嘛，还好，我们还可以通过sublime打造我们的js编译运行环境。</p>
<a id="more"></a>
<p>在sublime里直接编译运行某种语言主要是通过为sublime添加相应的的Build System实现的。而目前能够支持编译运行es6语法的也就node了，具体步骤如下。</p>
<p>1.Tools &gt; Build System &gt; New Build System<br>2.在打开的文件中添加如下代码<br>    <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    "<span class="attribute">path</span>": <span class="value"><span class="string">"/Users/vic/.nvm/versions/node/v5.3.0/bin"</span></span>,</span><br><span class="line">    "<span class="attribute">working_dir</span>": <span class="value"><span class="string">"$&#123;project_path:$&#123;folder&#125;&#125;"</span></span>,</span><br><span class="line">    "<span class="attribute">selector</span>": <span class="value"><span class="string">"source.js"</span></span>,</span><br><span class="line">    "<span class="attribute">encoding</span>": <span class="value"><span class="string">"utf-8"</span></span>,</span><br><span class="line">    "<span class="attribute">shell</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">    "<span class="attribute">windows</span>": <span class="value">&#123;</span><br><span class="line">        "<span class="attribute">cmd</span>": <span class="value">[<span class="string">"taskkill /f /im node.exe &gt;nul 2&gt;nul &amp; node $file"</span>]</span><br><span class="line">    </span>&#125;</span>,</span><br><span class="line">    "<span class="attribute">osx</span>": <span class="value">&#123;</span><br><span class="line">        "<span class="attribute">cmd</span>": <span class="value">[<span class="string">"killall node &gt;/dev/null 2&gt;&amp;1; node $file"</span>]</span><br><span class="line">    </span>&#125;</span>,</span><br><span class="line">    "<span class="attribute">linux</span>": <span class="value">&#123;</span><br><span class="line">        "<span class="attribute">cmd</span>": <span class="value">[<span class="string">"killall node &gt;/dev/null 2&gt;&amp;1; node $file"</span>]</span><br><span class="line">    </span>&#125;</span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.通过<code>which node</code>命令获取node的安装目录，添加到对应的path属性上<br>4.保存为<code>node.sublime-build</code><br>5.Tools &gt; Build System，选择刚才创建的<code>node</code><br>6.打开js文件，<code>cmd</code> + <code>b</code></p>
<p>这样我们就可以编译有es6语法的js文件了，但是还有一个问题，不同的node版本对es6语法的支持程度并不一样，当然了，版本越高，支持程度越好，一个查看你当前node版本对es6语法支持程度的办法就是运行阮一峰老师的<a href="https://github.com/ruanyf/es-checker" target="_blank" rel="external">es-checker</a>，全局安装后，执行<br><code>es-checker</code>命令。此文写作时Node最新稳定版本为v5.3.0，在该版本下执行<code>es-checker</code>命令后，控制台输出部分如下图所示：<br><img src="/images/es6InSublime/1.png" alt=""></p>
<p>我们发现即使是目前最新版本的Node对es6语法的支持依然有限。当然了node一直都是有所保留的，通过harmony相关的参数，我们能够开启node对更多es6语法的支持，以v5.3.0版本为例，如下图所示：<br><img src="/images/es6InSublime/2.png" alt=""></p>
<p>也就是，当我们通过<code>node --harmony</code>编译运行js代码的时候，node会开启目前所有完成的es6特性（不包括标注有in porgress的特性）。</p>
<p>如果你想在sublime中编译js时开启这些harmony特性，以osx为例有两个办法：</p>
<ol>
<li><p>在上文的Build System文件中将osx属性的值修改成如下所示</p>
 <figure class="highlight"><table><tr><td class="code"><pre><span class="line">"osx": &#123;</span><br><span class="line">    "cmd": ["killall node &gt;/dev/null 2&gt;&amp;1; node --harmony $file"]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>在shell脚本的配置文件(.bashrc/.zshrc)中为node命令设置别名，添加如下代码</p>
 <figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">alias <span class="keyword">node</span><span class="identifier"></span><span class="title">='node</span> --harmony'</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>但是，即便是为node开启了harmony，依然存在大量得不到支持的es6新特性，这时候就轮到<a href="https://github.com/babel/babel" target="_blank" rel="external">babel</a>登场了。</p>
<p>babel原名6to5，以前的名字听起来是很low，但是也很直观，它就是用来将目前运行环境还不支持的es6语法编译成es5语法的工具。babel目前最新版本为6.x，和之前的5.x版本还是有很大区别的，简单来说就是将命令行和API彻底分离，要想完成对es6语法的编译工作，需要额外通过.babelrc文件的preset和plugin属性指定相应的插件，具体可以参考<a href="https://cnodejs.org/topic/56460e0d89b4b49902e7fbd3" target="_blank" rel="external">这里</a>。</p>
<p>这里我们只说和sublime中编译运行js相关的事情，如果你目前刚好使用的是babel5.x，那么恭喜你省了很多事。我们像刚才那样新建一个Build System，不过这次它执行的不再是node命令，而是babel-node，具体步骤如下：</p>
<p>1.Tools &gt; Build System &gt; New Build System<br>2.在打开的文件中添加如下代码<br>    <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    "<span class="attribute">path</span>": <span class="value"><span class="string">"/Users/wangjinliang/.nvm/versions/node/v5.3.2/bin"</span></span>,</span><br><span class="line">    "<span class="attribute">working_dir</span>": <span class="value"><span class="string">"$&#123;project_path:$&#123;folder&#125;&#125;"</span></span>,</span><br><span class="line">    "<span class="attribute">selector</span>": <span class="value"><span class="string">"source.js"</span></span>,</span><br><span class="line">    "<span class="attribute">encoding</span>": <span class="value"><span class="string">"utf-8"</span></span>,</span><br><span class="line">    "<span class="attribute">shell</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">    "<span class="attribute">windows</span>": <span class="value">&#123;</span><br><span class="line">        "<span class="attribute">cmd</span>": <span class="value">[<span class="string">"taskkill /f /im node.exe &gt;nul 2&gt;nul &amp; babel-node $file"</span>]</span><br><span class="line">    </span>&#125;</span>,</span><br><span class="line">    "<span class="attribute">osx</span>": <span class="value">&#123;</span><br><span class="line">        "<span class="attribute">cmd</span>": <span class="value">[<span class="string">"killall node &gt;/dev/null 2&gt;&amp;1; babel-node $file"</span>]</span><br><span class="line">    </span>&#125;</span>,</span><br><span class="line">    "<span class="attribute">linux</span>": <span class="value">&#123;</span><br><span class="line">        "<span class="attribute">cmd</span>": <span class="value">[<span class="string">"killall node &gt;/dev/null 2&gt;&amp;1; babel-node $file"</span>]</span><br><span class="line">    </span>&#125;</span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.通过<code>which node</code>命令获取node的安装目录，添加到对应的path属性上<br>4.保存为<code>babel.sublime-build</code><br>5.Tools &gt; Build System，选择刚才创建的<code>babel</code><br>6.打开js文件，<code>cmd</code> + <code>b</code></p>
<p>但是你如果安装的是babel6.x版本，弄完上面那一套，你会发现和选择node编译运行，并没有什么区别，该不支持的特性还是不支持，原因就像上面说的babel6.x中单独分离出来的命令行工具babel-cli仅仅提供一些全局的命令，要想完成编译，还需要本地安装所需的插件（全局安装插件也没用的）。接下来有一个新的问题，需要安装哪些插件，介绍一个简单的方法，可以通过在.babelrc中添加preset属性来指定一个插件的集合，如下所示</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [<span class="string">"es2015"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在.babelrc所在目录中执行以下命令安装插件集</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm install babel-preset-es2015</span><br></pre></td></tr></table></figure>
<p>其他插件集可以参考<a href="https://www.npmjs.com/search?q=babel-preset" target="_blank" rel="external">npm</a></p>
<p>在.babelrc所在目录下新建js文件，输入代码后<code>cmd</code> + <code>b</code>，即可对es6语法的代码进行编译。<br><img src="/images/es6InSublime/3.png" alt=""></p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/01/15/extendInBabel/" class="prev">PREV</a><a href="/2015/11/29/textareaAutosize/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'fedviccom';
var disqus_identifier = '2015/12/24/es6InSublime/';
var disqus_title = '在sublime中编译ES6语法';
var disqus_url = 'http://fedvic.com/2015/12/24/es6InSublime/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//fedviccom.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2016 <a href="http://fedvic.com">vic</a>, unless otherwise noted.</p></div></footer><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>