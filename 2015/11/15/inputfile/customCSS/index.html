<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 关于input[type=file]那些事：如何定制样式 · Vic's Posts</title><meta name="description" content="关于input[type=file]那些事：如何定制样式 - vic"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/avatar.jpg"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/vicerwang" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://www.zhihu.com/people/wang-jin-liang-69" target="_blank" class="nav-list-link">ZHIHU</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">关于input[type=file]那些事：如何定制样式</h1><div class="post-meta"><div class="post-time">2015年11月15日</div></div><div class="post-content"><p><code>&lt;input type=&quot;file&quot;&gt;</code>由一个文本区域和一个浏览按钮组成，用于文件上传，是HTML表单元素中比较特殊的一个。由于涉及到向服务器上传文件这样敏感的安全问题，所以浏览器对其进行了诸多的限制，而且各家浏览器对其的支持也不尽相同，这给前端程序员的开发带来了很多麻烦。鉴于此，我准备写几篇关于<code>input[type=file]</code>的日常开发总结，希望能给大家带来帮助。</p>
<a id="more"></a>
<h2 id="u5982_u4F55_u5B9A_u5236_u6837_u5F0F"><a href="#u5982_u4F55_u5B9A_u5236_u6837_u5F0F" class="headerlink" title="如何定制样式"></a>如何定制样式</h2><p>首先，借用一张图来让我们来看下<code>input[type=file]</code>在各家浏览器千奇百怪的样子吧：</p>
<p><img src="/images/inputfile/fileInBrowsers.png" alt=""></p>
<p>这显然没有办法达到在不同浏览器相同体验的效果，好吧，那就让我们来定制一下我们自己的style吧，比如就是下面的这个简单效果：</p>
<p><img src="/images/inputfile/example.png" alt=""></p>
<p>但是当你准备开始写css时，你却又变得无从下手了，一个文本框＋一个按钮的这个控件样式怎么写呢，还想改变浏览按钮的文字怎么办呢，还好我们前端程序员总能机(ku)智(bi)想到各种神奇的办法解决这样的问题。</p>
<h3 id="u900F_u660E_u914D_u5408_u7EDD_u5BF9_u5B9A_u4F4D"><a href="#u900F_u660E_u914D_u5408_u7EDD_u5BF9_u5B9A_u4F4D" class="headerlink" title="透明配合绝对定位"></a>透明配合绝对定位</h3><p>html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"fileWrap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"file"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">button</span> <span class="attribute">type</span>=<span class="value">"button"</span>&gt;</span>浏览<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">class</span>=<span class="value">"fileName"</span>&gt;</span>请上传文件<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>css</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="class">.fileWrap</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">position</span>:<span class="value"> relative</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">overflow</span>:<span class="value"> hidden</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileWrap</span> <span class="tag">input</span><span class="attr_selector">[type=file]</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">position</span>:<span class="value"> absolute</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">top</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">left</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">opacity</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">filter</span>:<span class="value"> <span class="function">alpha</span>(opacity=<span class="number">0</span>)</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">cursor</span>:<span class="value"> pointer</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileWrap</span> <span class="tag">button</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100%</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100%</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#fff</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">1px</span> solid <span class="hexcolor">#ddd</span></span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileName</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">margin-left</span>:<span class="value"> <span class="number">10px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">line-height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>javascript</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> $fileName = $(<span class="string">'.fileName'</span>);</span><br><span class="line">$(<span class="string">'input[type=file]'</span>).change(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> path = $(<span class="keyword">this</span>).val();</span><br><span class="line">  <span class="keyword">var</span> fileName = path ? path.substr(path.lastIndexOf(<span class="string">'\\'</span>) + <span class="number">1</span>) : <span class="string">'请上传文件'</span>;</span><br><span class="line">  $fileName.text(fileName);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这是网上很常见的方法，原理就是将<code>input[type=file]</code>的透明度设置为0，同时在父元素中绝对定位，达到覆盖显示的可点击元素的目的，以上的代码放在chrome和firefox中完全没有问题，但是在IE8/9/10中却出现了两个问题：</p>
<ol>
<li>点击按钮的左侧后无法弹出文件选择框</li>
<li>按钮左侧出现光标</li>
</ol>
<p>就算在IE11中也有第二个问题，我们去掉对<code>input[type=file]</code>透明度css的设置，就会发现如下的情况：</p>
<p><img src="/images/inputfile/ie.png" alt=""></p>
<p>我们都知道<code>input[type=file]</code>包括一个文本区域和一个浏览按钮，在IE8/9/10中点击文本区域，是不会弹出文件选择框的，并且在所有的IE版本中即使将它设置为透明，依然会有光标的出现，要想解决这个问题，我们还要设置些额外的样式：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="class">.fileWrap</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">position</span>:<span class="value"> relative</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">overflow</span>:<span class="value"> hidden</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileWrap</span> <span class="tag">input</span><span class="attr_selector">[type=file]</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">position</span>:<span class="value"> absolute</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">top</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">left</span>:<span class="value"> -<span class="number">10px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">110px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">opacity</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">filter</span>:<span class="value"> <span class="function">alpha</span>(opacity=<span class="number">0</span>)</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">font-size</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">cursor</span>:<span class="value"> pointer</span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>将<code>input[type=file]</code>的<code>font-size</code>改为<code>100px</code>，可以让浏览按钮足够大来尽可能填充点击区域，但是依然会存在一小部分文本区域，那么我们通过设置<code>left</code>为负值以及增大相应<code>width</code>的方法，让浏览按钮填充整个点击区域。</p>
<h3 id="u9690_u85CF_u914D_u5408_u624B_u52A8_u89E6_u53D1click_u4E8B_u4EF6"><a href="#u9690_u85CF_u914D_u5408_u624B_u52A8_u89E6_u53D1click_u4E8B_u4EF6" class="headerlink" title="隐藏配合手动触发click事件"></a>隐藏配合手动触发click事件</h3><p>html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"fileWrap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"file"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">button</span> <span class="attribute">type</span>=<span class="value">"button"</span>&gt;</span>浏览<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">class</span>=<span class="value">"fileName"</span>&gt;</span>请上传文件<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>css</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="class">.fileWrap</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileWrap</span> <span class="tag">input</span><span class="attr_selector">[type=file]</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">display</span>:<span class="value"> none</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileWrap</span> <span class="tag">button</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100%</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100%</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#fff</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">1px</span> solid <span class="hexcolor">#ddd</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">outline</span>:<span class="value"> none</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">cursor</span>:<span class="value"> pointer</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileName</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">margin-left</span>:<span class="value"> <span class="number">10px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">line-height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>javascript</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> $file = $(<span class="string">'input[type=file]'</span>);</span><br><span class="line"><span class="keyword">var</span> $fileName = $(<span class="string">'.fileName'</span>);</span><br><span class="line">$(<span class="string">'.fileWrap button'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  $file.click();</span><br><span class="line">&#125;);</span><br><span class="line">$file.change(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> path = $(<span class="keyword">this</span>).val();</span><br><span class="line">  <span class="keyword">var</span> fileName = path ? path.substr(path.lastIndexOf(<span class="string">'\\'</span>) + <span class="number">1</span>) : <span class="string">'请上传文件'</span>;</span><br><span class="line">  $fileName.text(fileName);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>原理其实很简单，就是通过手动触发隐藏的<code>input[type=&quot;file&quot;]</code>的click事件来弹出文件选择框，但是这种解决方案在IE8下有一个很致命的问题，通过<a href="https://github.com/malsup/form" target="_blank" rel="external">jquery.form.js</a>异步提交表单的时候，会报拒绝访问的错误，原因是IE8出于安全的考虑不允许提交手动触发过click事件的<code>input[type=file]</code>。</p>
<h3 id="label_u6807_u7B7E_u6A21_u62DF"><a href="#label_u6807_u7B7E_u6A21_u62DF" class="headerlink" title="label标签模拟"></a>label标签模拟</h3><p>html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">label</span> <span class="attribute">class</span>=<span class="value">"fileWrap"</span>&gt;</span>浏览</span><br><span class="line">  <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"file"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">class</span>=<span class="value">"fileName"</span>&gt;</span>请上传文件<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>css</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="class">.fileWrap</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">display</span>:<span class="value"> block</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">position</span>:<span class="value"> relative</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">1px</span> solid <span class="hexcolor">#ddd</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#fff</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">text-align</span>:<span class="value"> center</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">line-height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">overflow</span>:<span class="value"> hidden</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">cursor</span>:<span class="value"> pointer</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileWrap</span> <span class="tag">input</span><span class="attr_selector">[type=file]</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">position</span>:<span class="value"> absolute</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">top</span>:<span class="value"> -<span class="number">50px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">left</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.fileName</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">margin-left</span>:<span class="value"> <span class="number">10px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">line-height</span>:<span class="value"> <span class="number">30px</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>javascript</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> $fileName = $(<span class="string">'.fileName'</span>);</span><br><span class="line">$(<span class="string">'input[type=file]'</span>).change(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> path = $(<span class="keyword">this</span>).val();</span><br><span class="line">  <span class="keyword">var</span> fileName = path ? path.substr(path.lastIndexOf(<span class="string">'\\'</span>) + <span class="number">1</span>) : <span class="string">'请上传文件'</span>;</span><br><span class="line">  $fileName.text(fileName);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这种解决方案就很巧妙了，利用<code>label</code>标签和表单元素关联后，点击label标签就相当于点击了表单元素的特性，来弹出文件选择框，相较于前两种解决方案更简单兼容性也更好。这里要注意的一点是，<code>input[type=file]</code>的<code>display</code>属性不能为<code>none</code>，否则就不会起作用，考虑到设置<code>visiblity: hidden;</code>可能会影响页面其他元素的布局，这里我通过设置绝对定位在父元素之外，并且设置父元素<code>overflow: hidden;</code>来达到隐藏不显示的目的。</p>
</div></article></div></section><footer><div class="paginator"><a href="/2015/11/16/inputfile/clearValue/" class="prev">上一篇</a><a href="/2015/11/14/liftoff/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'fedviccom';
var disqus_identifier = '2015/11/15/inputfile/customCSS/';
var disqus_title = '关于input[type=file]那些事：如何定制样式';
var disqus_url = 'http://fedvic.com/2015/11/15/inputfile/customCSS/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//fedviccom.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2016 <a href="http://fedvic.com">vic</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?a36e15d9e2adec9a21fcdd9f686b1ed2";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>